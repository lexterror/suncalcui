<html>
<head>
<title>World Map and Clock</title>
<script src="jquery.min.js"></script>
<script src="sinon.js"></script>
<script src="suncalc.js"></script>
<link rel="stylesheet" href="dist/style.css">
<script src="dist/d3.min.js"></script>
<script src="dist/topojson.min.js"></script>
<script src="dist/d3.geo.projection.min.js"></script>
<script src="dist/moment.min.js"></script>
<script src="dist/moment-timezone.min.js"></script>
<script src="daylight_map_script.js"></script>
<script src="worldclock.js"></script>
<style>
    a{
        box-sizing: content-box
    }
    @font-face {
            font-family: 'digital';

            src: url('fonts/Tabular-Medium.eot');

                /* IE9 Compat Modes */

            src: url('fonts/Tabular-Regular.eot?#iefix') format('embedded-opentype'),
                /* IE6-IE8 */

                 url('fonts/Tabular-Regular.woff2') format('woff2'),
                /* Super Modern Browsers */

                 url('fonts/Tabular-Regular.woff') format('woff'),
                /* Pretty Modern Browsers */

                 url('fonts/Tabular-Regular.ttf') format('truetype');
 
                /* Safari, Android, iOS */
    } 
</style>
    <meta name="viewport" content="width=device-width">
    <link rel="shortcut icon" href="star.ico">
    <style>
    body {
        background: #333;
        width: 880px;
        margin: 0 auto;
        }
   .container {
        width: 890px;
        margin: 0 auto;
        border: 5px solid #111;
   }
   clock_disp {
        width: 880px;
        margin: 0 auto;
   }
   #mycustomclocks {
       width:880px;
       height:32px;
       padding-bottom: 8px;
   }
   #mycustomclocks2 {
       width:880px;
       height:32px;
       padding-bottom: 8px;
   }
   #newcustomclock button {
       height:40px;
       float:left;
       background:#aaaaaa;
       font-size: 12px;
       line-height: 12px;
       color:#000;
       font-family:  digital;
       border:1px solid #999999;
       margin-left: 1px;
       width: 175px;
   }
/* http://meyerweb.com/eric/tools/css/reset/ 
   v2.0 | 20110126
   License: none (public domain)
*/

html, body, div, span, applet, object, iframe,
h1, h2, h3, h4, h5, h6, p, blockquote, pre,
a, abbr, acronym, address, big, cite, code,
del, dfn, em, img, ins, kbd, q, s, samp,
small, strike, strong, sub, sup, tt, var,
b, u, i, center,
dl, dt, dd, ol, ul, li,
fieldset, form, label, legend,
table, caption, tbody, tfoot, thead, tr, th, td,
article, aside, canvas, details, embed, 
figure, figcaption, footer, header, hgroup, 
menu, nav, output, ruby, section, summary,
time, mark, audio, video {
    margin: 0 auto;
    padding: 0;
    border: 0;
    font-size: 100%;
    font: inherit;
    vertical-align: baseline;
}
/* HTML5 display-role reset for older browsers */
article, aside, details, figcaption, figure, 
footer, header, hgroup, menu, nav, section {
    display: block;
}
body {
    line-height: 1;
}
ol, ul {
    list-style: none;
}
blockquote, q {
    quotes: none;
}
blockquote:before, blockquote:after,
q:before, q:after {
    content: '';
    content: none;
}
table {
    border-collapse: collapse;
    border-spacing: 0;
}  
#daylight-map {
    padding: 0 !important;
    border: 0 !important;
}
    </style>
</head>
<body>
<div class="container">
<div id="mycustomclockstop">

<div id="newcustomclock">
<button type="button" onclick="button1func()" id="buttoncity1">
</button></div>

<div id="newcustomclock">
<button type="button" onclick="button2func()" id="buttoncity2">
</button></div>

<div id="newcustomclock">
<button type="button" onclick="button3func()" id="buttoncity3">
</button></div>

<div id="newcustomclock">
<button type="button" onclick="button4func()" id="buttoncity4">
</button></div>

<div id="newcustomclock">
<button type="button" onclick="button5func()" id="buttoncity5">
</button></div>

</div>

<svg id="daylight-map"></svg>
<img src="bigcities.png" id="big1" width="16" height="16" title="" style="position: absolute;">
<img src="bigcities.png" id="big2" width="16" height="16" title="" style="position: absolute;">
<img src="bigcities.png" id="big3" width="16" height="16" title="" style="position: absolute;">
<img src="bigcities.png" id="big4" width="16" height="16" title="" style="position: absolute;">
<img src="bigcities.png" id="big5" width="16" height="16" title="" style="position: absolute;">
<img src="bigcities.png" id="big6" width="16" height="16" title="" style="position: absolute;">
<img src="bigcities.png" id="big7" width="16" height="16" title="" style="position: absolute;">
<img src="bigcities.png" id="big8" width="16" height="16" title="" style="position: absolute;">
<img src="bigcities.png" id="big9" width="16" height="16" title="" style="position: absolute;">
<img src="bigcities.png" id="big10" width="16" height="16" title="" style="position: absolute;">
<img src="bigcities.png" id="big11" width="16" height="16" title="" style="position: absolute;">
<img src="bigcities.png" id="big12" width="16" height="16" title="" style="position: absolute;">
<img src="bigcities.png" id="big13" width="16" height="16" title="" style="position: absolute;">
<img src="bigcities.png" id="big14" width="16" height="16" title="" style="position: absolute;">
<img src="bigcities.png" id="big15" width="16" height="16" title="" style="position: absolute;">
<img src="bigcities.png" id="big16" width="16" height="16" title="" style="position: absolute;">
<img src="bigcities.png" id="big17" width="16" height="16" title="" style="position: absolute;">
<img src="bigcities.png" id="big18" width="16" height="16" title="" style="position: absolute;">
<img src="bigcities.png" id="big19" width="16" height="16" title="" style="position: absolute;">
<img src="bigcities.png" id="big20" width="16" height="16" title="" style="position: absolute;">
<img src="bigcities.png" id="big21" width="16" height="16" title="" style="position: absolute;">
<img src="bigcities.png" id="big22" width="16" height="16" title="" style="position: absolute;">
<img src="bigcities.png" id="big23" width="16" height="16" title="" style="position: absolute;">
<img src="bigcities.png" id="big24" width="16" height="16" title="" style="position: absolute;">
<img src="home.gif" id="casa" width="32" height="32" title="">
<style>
#location {
position: absolute;
height: 440px;
width:880px;
top: 0;
}
#location span {
  position: absolute;
  top: 20;
  bottom: 0;
  left: 0;
  right: 0;
  color: #fff;
  visibility: hidden;
  opacity: 1;
}
#location:hover #mycity {
    visibility: visible;
    opacity: 1;
}
#customtime {
    width: 880px;
    float: left;
    height: 32px;
    color: #fff;
    margin: 0 auto;
    padding-top: 10px;
    font-family: digital;
    z-index: 999999999999;
    background: #666;
    vertical-align: middle;
    }
#customtimebar {
    padding-left: 10px;
    margin: 0 auto;
}
#changeloc {
 width: 48px;
}
#localstuff {
    width: 880px;
    height: 24px;
    padding-top: 10px;
    line-height: 24px;
    background: #aaa;
    padding-bottom: 10px;
    color: #000 !important;
    margin:0 auto;
    text-align: center;
}   
#mytime {
    float: right;
    font-family: digital;
    font-size: 24px;
    color: #000; 
}
#mycity {
    font-family: digital;
    font-size: 12px;
    z-index: 5555555555555;
    color: #000; 
}
img:focus::before {
    content: attr(title);
}
</style>



<div id="mycustomclocks">

<div id="newcustomclock">
<button type="button" id="homeclock" onclick="gohome()" style="background:lawngreen !important;">
</button></div>

<div id="newcustomclock">
<button type="button" onclick="button6func()"  id="buttoncity6">
</button></div>

<div id="newcustomclock">
<button type="button" onclick="button7func()"  id="buttoncity7">
</button></div>

<div id="newcustomclock">
<button type="button" onclick="button8func()" id="buttoncity8">
</button></div>

<div id="newcustomclock">
<button type="button" style="width:87px !important;">
<img id="phase" width="32" height="32" style="z-index: 55555 !important;"></img>
</button>
<button type="button" id="show" style="width:87px !important;">Display All</button></div>

</div>
    <div id="result">
        <!--Position information will be inserted here-->
    </div>
    <button type="button" onclick="showPosition();" style="width:880px;height:32px;">Show Accurate Position Data</button>
<script>
$(document).ready(function(){
 var title = $("#casa").attr("title");
 $(title).show();
 var bigcity1 = $("#big1").attr("title");
 $(bigcity1).show();
 var bigcity2 = $("#big2").attr("title");
 $(bigcity2).show();
 var bigcity2 = $("#big3").attr("title");
 $(bigcity2).show();
 var bigcity4 = $("#big4").attr("title");
 $(bigcity4).show();
 var bigcity5 = $("#big5").attr("title");
 $(bigcity5).show();
 var bigcity6 = $("#big6").attr("title");
 $(bigcity6).show();
 var bigcity7 = $("#big7").attr("title");
 $(bigcity7).show();
 var bigcity8 = $("#big8").attr("title");
 $(bigcity8).show();
  var bigcity9 = $("#big9").attr("title");
 $(bigcity9).show();
 var bigcity10 = $("#big10").attr("title");
 $(bigcity10).show();
  var bigcity11 = $("#big11").attr("title");
 $(bigcity11).show();
  var bigcity12 = $("#big12").attr("title");
 $(bigcity12).show();
  var bigcity13 = $("#big13").attr("title");
 $(bigcity13).show();
 var bigcity14 = $("#big14").attr("title");
 $(bigcity14).show();
});
</script>
<script>
function gohome() {
    button1 = 0;
    button2 = 0;
    button3 = 0;
    button4 = 0;
    button5 = 0;
    button6 = 0;
    button7 = 0;
    button8 = 0;
    mychange++;
	update_clock();
    mychange--;
	update_clock();
}
function button1func() { 
    button1 = 1;
    button2 = 0;
    button3 = 0;
    button4 = 0;
    button5 = 0;
    button6 = 0;
    button7 = 0;
    button8 = 0;
    mychange++;
	update_clock();
    mychange--;
	update_clock();
	}
function button2func() { 
    button1 = 0;
    button2 = 1;
    button3 = 0;
    button4 = 0;
    button5 = 0;
    button6 = 0;
    button7 = 0;
    button8 = 0;
    mychange++;
	update_clock();
    mychange--;
	update_clock();
	}
function button3func() { 
    button1 = 0;
    button2 = 0;
    button3 = 1;
    button4 = 0;
    button5 = 0;
    button6 = 0;
    button7 = 0;
    button8 = 0;
    mychange++;
	update_clock();
    mychange--;
	update_clock();
	}
function button4func() { 
    button1 = 0;
    button2 = 0;
    button3 = 0;
    button4 = 1;
    button5 = 0;
    button6 = 0;
    button7 = 0;
    button8 = 0;
    mychange++;
	update_clock();
    mychange--;
	update_clock();
	}
function button5func() { 
    button1 = 0;
    button2 = 0;
    button3 = 0;
    button4 = 0;
    button5 = 1;
    button6 = 0;
    button7 = 0;
    button8 = 0;
    mychange++;
	update_clock();
    mychange--;
	update_clock();
	}
function button6func() { 
    button1 = 0;
    button2 = 0;
    button3 = 0;
    button4 = 0;
    button5 = 0;
    button6 = 1;
    button7 = 0;
    button8 = 0;
    mychange++;
	update_clock();
    mychange--;
	update_clock();
	}
function button7func() { 
    button1 = 0;
    button2 = 0;
    button3 = 0;
    button4 = 0;
    button5 = 0;
    button6 = 0;
    button7 = 1;
    button8 = 0;
    mychange++;
	update_clock();
    mychange--;
	update_clock();
	}
function button8func() { 
    button1 = 0;
    button2 = 0;
    button3 = 0;
    button4 = 0;
    button5 = 0;
    button6 = 0;
    button7 = 0;
    button8 = 1;
    mychange++;
	update_clock();
    mychange--;
	update_clock();
	}
</script>
<script>
$(document).ready(function(){
    $('#show').click(function() {
      $('.timezones').toggle("slide");
    });
});
</script>

<div class="timezones" style="display: none;">
<div id="customtime"><div id="customtimebar">
  <button type="button" id="changeloc" onclick="right();">&larr;</button>
  <button type="button" id="changeloc" onclick="left();">&rarr;</button> 
  Year: <input type="text" name="year" id="year" style="width:50px;">
  Month: <input type="text" name="month" id="month" style="width:50px;">
  Date: <input type="text" name="date" id="date" style="width:50px;">
  Hour: <input type="text" name="date" id="hours" style="width:50px;">
  Minute: <input type="text" name="date" id="minutes" style="width:50px;">
  <button type="button" onclick="custom();">Go!</button>
  <button type="button" onclick="reset();">Reset!</button>  
</div>
</div>

<script>
function left(){
mychange--;
update_clock();
}
function right(){
mychange++;
update_clock();
}
</script>
<div id="clock_disp"></div>
</div>
</div>
<style>
#clock_disp {

    margin-top: 10px;
}
#topinfo {
    font-family: digital;
    background: #999;
    color: #000;
    width: 880px;
    height: 24px;
    font-size: 16px;
    line-height: 24px;
    margin: 0 auto;
    text-align: left;
    margin-bottom: 1px;
    
}
#show {

    padding: 5px;
    border: 0;
    
    
}
#worldclock {
    z-index: 999999999999;
}
#moonphasetext {
    font-size: 12px;
    line-height: 24px;
    vertical-align: middle;
}
#localtoast table {
    color: #ffffff;
}
#localtoast td {
    height: 14px;
    padding: 5px !important;
}
#localtoast table, #localtoast td, #localtoast th {
  border: 1px solid #aaa;
  color: #fff;
  background-image: url("toast.png");background-repeat: repeat;
}
#moonphase {
    z-index: 555555 !important;
    font-family: digital;
    background: #666;
    border: 1px solid #000;
    color: #ffffff;
    vertical-align: middle;
    height: 32px;
}
</style>
</body>
<script>

  var ispressed = 1;

  function custom() {
  if (ispressed == 1)
  {
  var year = document.getElementById("year").value;
  var month = document.getElementById("month").value - 1;
  var date = document.getElementById("date").value;
  var hour = document.getElementById("hours").value;
  var minutes = document.getElementById("minutes").value;
  clock = sinon.useFakeTimers(new Date(year,month,date,hour,minutes).getTime());
  new Date();
  update_clock();
  MySunCalc();
  
  map.currDate = new Date();
  map.init();

  ispressed = 0;
  }
  }

  function reset() {
  ispressed = 1;
  clock.restore();
  new Date(); //=> will return the real time again (now)  
  update_clock();
  MySunCalc();
   
  map.currDate = new Date();
  map.init();  
  }
</script>
<style>
#result {
    color: #fff;
    background: #999;
    width: 880px;
    height: 32px;
    font-family: digital;
    font-size:12px;
    line-height: 16px;
    margin: 0 auto;
    text-align: center;
}
</style>
<script>
    function showPosition() {
        if(navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(function(position) {
                var latitude = position.coords.latitude;
                var longitude = position.coords.longitude;
                ///////////////////////
    
    var x = new Date();
    var currentTimeZoneOffsetInHours = x.getTimezoneOffset() / 60;  
    function pad(value) {
        return value < 10 ? '0' + value : value;
    }
    function createOffset(date) {
        var sign = (date.getTimezoneOffset() > 0) ? "-" : "+";
        var offset = Math.abs(date.getTimezoneOffset());
        var hours = pad(Math.floor(offset / 60));
        var minutes = pad(offset % 60);
      //  return sign + hours + ":" + minutes;
        return sign + hours;
    }
    var newoffset = createOffset(x);
    
    
    
    
            function checkTime(x) {
            if (x < 10) {
            x = "0" + x;
            };
            return x;
            }   
            var Location_off = newoffset;
            var location = SunCalc.getTimes(new Date(),latitude,longitude);
            var Location_Sunrise_minutes = checkTime(location.sunrise.getMinutes());
            var location_utc_sunrise = location.sunrise.getTime()+(location.sunrise.getTimezoneOffset() * 60000);
            var location_nd_sunrise = new Date(location_utc_sunrise+(3600000*Location_off));
            var location_sunriseStr = checkTime(location_nd_sunrise.getHours()) + ':' + Location_Sunrise_minutes;
            var h = checkTime(location_nd_sunrise.getHours());            
            
            if (isampm == 1)
            {
                var ap = (h >= 12)?"PM":"AM";
                h = (h % 12);
                if(h == 0) h = 12;
                LocationSunriseStr = checkTime(h) + ":" + Location_Sunrise_minutes + " " + ap;
            }
            
            else{
            LocationSunriseStr = location_sunriseStr;
            }            
            
            var Location_Sunset_minutes = checkTime(location.sunset.getMinutes());
            var location_utc_sunset = location.sunset.getTime()+(location.sunset.getTimezoneOffset() * 60000);
            var location_nd_sunset = new Date(location_utc_sunset+(3600000*Location_off));
            var location_sunsetStr = checkTime(location_nd_sunset.getHours()) + ':' + Location_Sunset_minutes;
            var h = checkTime(location_nd_sunset.getHours());

            if (isampm == 1)
            {
                var ap = (h >= 12)?"PM":"AM";
                h = (h % 12);
                if(h == 0) h = 12;
                LocationSunsetStr = checkTime(h) + ":" + Location_Sunset_minutes + " " + ap;
            }
            else {
            LocationSunsetStr = location_sunsetStr;
            }
	
            var moonLocation_off = newoffset;
            var moonlocation = SunCalc.getMoonTimes(new Date(), latitude,longitude);
            var checkundef1 = moonlocation.rise;
            var checkundef2 = moonlocation.set;
			if (checkundef1 === undefined)
			{
            if (isampm == 1 || myboolean == 1)					
			LocationMoonriseStr = "--------";
            else
			LocationMoonriseStr = "-----";			
			}
			if (checkundef1 !== undefined)
            {
            var Location_Moonrise_minutes = checkTime(moonlocation.rise.getMinutes());
            var location_utc_moonrise = moonlocation.rise.getTime()+(moonlocation.rise.getTimezoneOffset() * 60000);
            var location_nd_moonrise = new Date(location_utc_moonrise+(3600000*Location_off));
            var location_moonriseStr = checkTime(location_nd_moonrise.getHours()) + ':' + Location_Moonrise_minutes;
            var h = checkTime(location_nd_moonrise.getHours());            
            
            if (isampm == 1 || myboolean == 1)
            {
                var ap = (h >= 12)?"PM":"AM";
                h = (h % 12);
                if(h == 0) h = 12;
                LocationMoonriseStr = checkTime(h) + ":" + Location_Moonrise_minutes + " " + ap;
            }
                     
            else {
            LocationMoonriseStr = location_moonriseStr;
            }               
            }
            
			if (checkundef2 === undefined)
			{      
            if (isampm == 1)	
 			LocationMoonsetStr = "--------";
            else
 			LocationMoonsetStr = "-----";			
			}     
			if (checkundef2 !== undefined)
            {
            var Location_Moonset_minutes = checkTime(moonlocation.set.getMinutes());
            var location_utc_moonset = moonlocation.set.getTime()+(moonlocation.set.getTimezoneOffset() * 60000);
            var location_nd_moonset = new Date(location_utc_moonset+(3600000*Location_off));
            var location_moonsetStr = checkTime(location_nd_moonset.getHours()) + ':' + Location_Moonset_minutes;
            var h = checkTime(location_nd_moonset.getHours());
        
            if (isampm == 1)
            {
                var ap = (h >= 12)?"PM":"AM";
                h = (h % 12);
                if(h == 0) h = 12;
            LocationMoonsetStr = checkTime(h) + ":" + Location_Moonset_minutes + " " + ap;
            }
                     
            else {
            LocationMoonsetStr = location_moonsetStr;
            }          
            }
                           
                    newMarginTop = (marginT - ((latitude * 2.444))) + 5;
                    newMarginLeft = (marginL + ((longitude * 2.444))) - 15;
                    document.getElementById("casa").style.marginLeft = newMarginLeft;
                    document.getElementById("casa").style.marginTop = newMarginTop;     
                
                ///////////////////////
                var positionInfo = "Your current position is (" + "<font color='black'>Latitude:</font> " + position.coords.latitude + ", " + "<font color='black'>Longitude:</font> " + position.coords.longitude + ")<br>" +
                "<font color='black'>UTC:</font> " + newoffset + " <font color='black'>Sunrise:</font> " + LocationSunriseStr + " <font color='black'>Sunset:</font> " + LocationSunsetStr + " <font color='black'>Moonrise:</font> " + LocationMoonriseStr + " <font color='black'>Moonset:</font> " + LocationMoonsetStr;
                
                document.getElementById("result").innerHTML = positionInfo;
            });
        } else {
            alert("Sorry, your browser does not support HTML5 geolocation.");
        }
    }
</script>
</html>
